(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{185:function(s,e,a){"use strict";a.r(e);var t=a(0),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"promethus-简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#promethus-简介"}},[s._v("#")]),s._v(" promethus 简介")]),s._v(" "),a("p",[s._v("Prometheus是一套开源的系统监控报警框架。具有一下特点：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("多维度数据")])]),s._v(" "),a("li",[a("p",[s._v("支持强大的存储")])]),s._v(" "),a("li",[a("p",[s._v("出色的可视化")])]),s._v(" "),a("li",[a("p",[s._v("高效存储")])]),s._v(" "),a("li",[a("p",[s._v("操作简单")])]),s._v(" "),a("li",[a("p",[s._v("精确警报")])]),s._v(" "),a("li",[a("p",[s._v("支持多种客户端")])])]),s._v(" "),a("h2",{attrs:{id:"使用docker搭建promethus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用docker搭建promethus"}},[s._v("#")]),s._v(" 使用docker搭建promethus")]),s._v(" "),a("ul",[a("li",[s._v("准备配置文件")])]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# my global config")]),s._v("\nglobal:\n  scrape_interval:     15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.\n  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("  # scrape_timeout is set to the global default (10s).")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Alertmanager configuration")]),s._v("\nalerting:\n  alertmanagers:\n  - static_configs:\n    - targets:\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("      # - alertmanager:9093")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Load rules once and periodically evaluate them according to the global 'evaluation_interval'.")]),s._v("\nrule_files:\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('  # - "first_rules.yml"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('  # - "second_rules.yml"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# A scrape configuration containing exactly one endpoint to scrape:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Here it's Prometheus itself.")]),s._v("\nscrape_configs:\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("  # The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br")])]),a("ul",[a("li",[s._v("把监控数据存储到influxdb里")])]),s._v(" "),a("p",[s._v("在Prometheus配置文件继续添加添加")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[s._v('remote_write:\n  - url: "http://192.168.3.3:8086/api/v1/prom/write?db'),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('prometheus"')]),s._v('\n\nremote_read:\n  - url: "http://192.168.3.3:8086/api/v1/prom/read?db'),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('prometheus"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("influxdb支持通过HTTP API的方式，读写数据。所以只需填写influxdb的url和数据库名称即可")]),s._v(" "),a("p",[s._v("influxdb默认没有密码认证。如果influxdb开启的密码认证，需要在配置文件添加上用户名和密码")]),s._v(" "),a("div",{staticClass:"language-ini line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-ini"}},[a("code",[s._v('remote_write:\n  - url: "http://192.168.3.3:8086/api/v1/prom/write?db'),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('prometheus&u=prometheus&p=123456"')]),s._v('\n\nremote_read:\n  - url: "http://192.168.3.3:8086/api/v1/prom/read?db'),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v('prometheus&u=prometheus&p=123456"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[s._v("启动docker容器,并把宿主机配置文件映射到容器内部")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("docker container run --name promethus -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v(":9090 -v "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PWD")]),s._v("/etc/prometheus.yml:/etc/prometheus/prometheus.yml -v /etc/localtime:/etc/localtime -d prom/prometheus\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这样promethus容器就启动成功了。下次让promethus可以读取Linux主机的监控数据。")])])}),[],!1,null,null,null);e.default=n.exports}}]);